<!DOCTYPE html>
<html>
  <head>
    <title>Animations Quicktest</title>
    <link rel="stylesheet" type="text/css" href="../../plottable.css">
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="../../plottable.js"></script>
    <script src="../../examples/exampleUtil.js"></script>

    <script>
      function randomData(n) {
        var res = [];
        for (var i=0;i++<n;){
          res.push({x:10*i/n,y:10*i/n*Math.random()});
        }
        return res;
      }
      var xyDataSource = new Plottable.DataSource(makeRandomData(40));

      var doAnimate = true;

      var barData = [
        { x: "A", y: Math.random()*10-2},
        { x: "B", y: Math.random()*10-2},
        { x: "C", y: Math.random()*10-2},
        { x: "D", y: Math.random()*10-2},
        { x: "E", y: Math.random()*10-2}
      ];
      var barDataSource = new Plottable.DataSource(barData);

      var circleRenderer;
      function makeCircleChart() {
        var xScale = new Plottable.LinearScale();
        var xAxis = new Plottable.XAxis(xScale, "bottom");

        var yScale = new Plottable.LinearScale();
        var yAxis = new Plottable.YAxis(yScale, "left");

        circleRenderer = new Plottable.CircleRenderer(xyDataSource, xScale, yScale);
        circleRenderer.project("r", 8);
        circleRenderer.project("opacity", 0.75);
        circleRenderer.animate(doAnimate);

        var circleChart = new Plottable.Table([[yAxis, circleRenderer],
                                               [null,  xAxis]]);
        circleChart.renderTo("#circles");
      }

      var barRenderer;
      function makeBarChart() {
        var xScale = new Plottable.OrdinalScale().rangeType("bands");
        var xAxis = new Plottable.XAxis(xScale, "bottom", function(d) { return d; } );

        var yScale = new Plottable.LinearScale();
        var yAxis = new Plottable.YAxis(yScale, "left");
        yAxis.showEndTickLabels(true);

        barRenderer = new Plottable.BarRenderer(barDataSource, xScale, yScale)
                                .project("fill", function() {return "steelblue"});
        barRenderer.animate(doAnimate);
        var barChart = new Plottable.Table([[yAxis, barRenderer],
                                         [null,  xAxis]]);
        barChart.renderTo("#bars");
      }

      var lineRenderer;
      function makeLineChart() {
        var xScale = new Plottable.LinearScale();
        var xAxis = new Plottable.XAxis(xScale, "bottom");

        var yScale = new Plottable.LinearScale();
        var yAxis = new Plottable.YAxis(yScale, "left");

        lineRenderer = new Plottable.LineRenderer(xyDataSource, xScale, yScale);
        lineRenderer.animate(doAnimate);
        var lineChart = new Plottable.Table([[yAxis, lineRenderer],
                                               [null,  xAxis]]);
        lineChart.renderTo("#line");
      }

      var areaRenderer;
      function makeAreaChart() {
        var xScale = new Plottable.LinearScale();
        var xAxis = new Plottable.XAxis(xScale, "bottom");

        var yScale = new Plottable.LinearScale();
        var yAxis = new Plottable.YAxis(yScale, "left");

        areaRenderer = new Plottable.AreaRenderer(xyDataSource, xScale, yScale);
        areaRenderer.animate(doAnimate);
        var areaChart = new Plottable.Table([[yAxis, areaRenderer],
                                               [null,  xAxis]]);
        areaChart.renderTo("#area");
      }

      window.onload = function() {
        makeCircleChart();
        makeBarChart();
        makeLineChart();
        makeAreaChart();
      }

      function changeData() {
        xyDataSource.data(makeRandomData(40));
        barData.forEach(function(d) { d.y = Math.random()*10-2; });
        barDataSource.data(barData);
      }

      function toggleAnimations() {
        doAnimate = !doAnimate;
        circleRenderer.animate(doAnimate);
        barRenderer.animate(doAnimate);
        lineRenderer.animate(doAnimate);
        areaRenderer.animate(doAnimate);
        d3.select("#toggle").text((doAnimate?"Disable":"Enable")+" Animations");
      }

    </script>
  </head>
  <body>
    <table>
      <tr>
        <td><svg id="circles" width="480" height="320"></svg></td>
        <td><svg id="bars" width="480" height="320"></svg></td>
      </tr>
      <tr>
        <td colspan="2"><div style="text-align:center;">
          <button name="changeData" onclick="changeData()">Change Data</button>
          <button id="toggle" onclick="toggleAnimations()">Disable Animations</button>
        </div></td>
      </tr>
      <tr>
        <td><svg id="line" width="480" height="320"></svg></td>
        <td><svg id="area" width="480" height="320"></svg></td>
      </tr>
  </body>

</html>
