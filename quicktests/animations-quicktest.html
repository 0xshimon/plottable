<!DOCTYPE html>
<html>
  <head>
    <title>Animations Quicktest</title>
    <link rel="stylesheet" type="text/css" href="../../plottable.css">
    <script src="../bower_components/d3/d3.js" charset="utf-8"></script>
    <script src="../../plottable_multifile.js"></script>
    <script src="../../examples/exampleUtil.js"></script>

    <script>

      function randomData(n) {
        var res = [];
        for (var i=0;i++<n;){
          res.push({x:10*i/n,y:10*i/n*Math.random()});
        }
        return res;
      }
      var xyDataSource = new Plottable.DataSource(makeRandomData(40));

      var doAnimate = true;

      function generate_bar_value() {
        return Math.random()*10 - 2;
      }
      var barData = [];
      for (var i=0; i<18; i++) {
        barData.push({ x: String.fromCharCode(65+i), y: generate_bar_value() });
      }
      var barDataSource = new Plottable.DataSource(barData);

      var circlePlot;
      function makeCircleChart() {
        var xScale = new Plottable.Scale.Linear();
        var xAxis = new Plottable.Axis.XAxis(xScale, "bottom");

        var yScale = new Plottable.Scale.Linear();
        var yAxis = new Plottable.Axis.YAxis(yScale, "left");

        circlePlot = new Plottable.Plot.Scatter(xyDataSource, xScale, yScale);
        circlePlot.project("r", 8);
        circlePlot.project("opacity", 0.75);
        circlePlot.animate(doAnimate);

        var circleChart = new Plottable.Component.Table([[yAxis, circlePlot],
                                               [null,  xAxis]]);
        circleChart.renderTo("#circles");
      }

      var barPlot;
      function makeBarChart() {
        var xScale = new Plottable.Scale.Ordinal().rangeType("bands");
        var xAxis = new Plottable.Axis.XAxis(xScale, "bottom", function(d) { return d; } );

        var yScale = new Plottable.Scale.Linear();
        var yAxis = new Plottable.Axis.YAxis(yScale, "left");
        yAxis.showEndTickLabels(true);

        barPlot = new Plottable.Plot.VerticalBar(barDataSource, xScale, yScale)
                                .project("fill", function() {return "steelblue"});
        barPlot.animate(doAnimate);
        var barChart = new Plottable.Component.Table([[yAxis, barPlot],
                                         [null,  xAxis]]);
        barChart.renderTo("#bars");
      }

      var linePlot;
      function makeLineChart() {
        var xScale = new Plottable.Scale.Linear();
        var xAxis = new Plottable.Axis.XAxis(xScale, "bottom");

        var yScale = new Plottable.Scale.Linear();
        var yAxis = new Plottable.Axis.YAxis(yScale, "left");

        linePlot = new Plottable.Plot.Line(xyDataSource, xScale, yScale);

        linePlot.animate(doAnimate);
        var lineChart = new Plottable.Component.Table([[yAxis, linePlot],
                                               [null,  xAxis]]);
        lineChart.renderTo("#line");
      }

      var areaPlot;
      function makeAreaChart() {
        var xScale = new Plottable.Scale.Linear();
        var xAxis = new Plottable.Axis.XAxis(xScale, "bottom");

        var yScale = new Plottable.Scale.Linear();
        var yAxis = new Plottable.Axis.YAxis(yScale, "left");

        areaPlot = new Plottable.Plot.Area(xyDataSource, xScale, yScale);
        areaPlot.animate(doAnimate);
        var areaChart = new Plottable.Component.Table([[yAxis, areaPlot],
                                               [null,  xAxis]]);
        areaChart.renderTo("#area");
      }

      window.onload = function() {
        makeCircleChart();
        makeBarChart();
        makeLineChart();
        makeAreaChart();
      }

      function changeData() {
        xyDataSource.data(makeRandomData(40));
        barData.forEach(function(d) { d.y = generate_bar_value(); });
        barDataSource.data(barData);
      }

      function toggleAnimations() {
        doAnimate = !doAnimate;
        circlePlot.animate(doAnimate);
        barPlot.animate(doAnimate);
        linePlot.animate(doAnimate);
        areaPlot.animate(doAnimate);
        d3.select("#toggle").text((doAnimate?"Disable":"Enable")+" Animations");
      }

    </script>
  </head>
  <body>
    <table>
      <tr>
        <td><svg id="circles" width="480" height="320"></svg></td>
        <td><svg id="bars" width="480" height="320"></svg></td>
      </tr>
      <tr>
        <td colspan="2"><div style="text-align:center;">
          <button name="changeData" onclick="changeData()">Change Data</button>
          <button id="toggle" onclick="toggleAnimations()">Disable Animations</button>
        </div></td>
      </tr>
      <tr>
        <td><svg id="line" width="480" height="320"></svg></td>
        <td><svg id="area" width="480" height="320"></svg></td>
      </tr>
  </body>

</html>
